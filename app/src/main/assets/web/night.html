<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="Author" content="VBE">
    <meta name="Keywords" content="邠心,邠心工作室">
    <meta name="Description" content="邠心工作室-21天学通Java-代码编辑器">
    <meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link href="css/common.css" rel="stylesheet" />
    <link href="css/ace.css" rel="stylesheet" />
    <link href="css/vbea_night.css" rel="stylesheet" />
    <title>Code Editor</title>
</head>
<body ontouchstart>
    <div id="headBar">
        <div id="headTitle">
            <span id="lang"></span>
        </div>
        <div id="headBtns" style="width:170px;">
            <img onclick="javascript:exec(true, 'del', 'Delete')" src="image/ic_delete.png" />
            <img onclick="javascript:exec(false, 'selectall', 'Ctrl-A')" src="image/ic_selectall.png" />
            <img onclick="javascript:exec(false, 'undo','Ctrl-Z')" src="image/ic_undo.png" />
            <img onclick="javascript:exec(false, 'redo','Ctrl-Y')" src="image/ic_redo.png" />
            <img onclick="javascript:exec(false, 'find', 'Ctrl-F')" src="image/ic_search.png" />
        </div>
    </div>
    <pre id="vbeditor"></pre>
    <div id="statusBar">
        <img onclick="javascript:exec(true, 'indent','Tab')" src="image/ic_tab.png" />
        <img onclick="javascript:exec(true, 'gotoleft', 'Left');" src="image/ic_left.png" />
        <img onclick="javascript:exec(true, 'gotoright', 'Left');" src="image/ic_right.png" />
        <img onclick="javascript:exec(true, 'golineup', 'Up');" src="image/ic_up.png" />
        <img onclick="javascript:exec(true, 'golinedown', 'Down');" src="image/ic_down.png" />
        <img onclick="javascript:exec(true, 'togglecomment', 'Ctrl-/');" src="image/ic_comment.png" />
        <img onclick="javascript:exec(true, 'toggleBlockComment', 'Ctrl-Shift-/');" src="image/ic_comments.png" />
    </div>
    <script src="src/ace.js" type="text/javascript" charset="utf-8"></script>
    <script src="src/ext-language_tools.js"></script>
    <script src="src/ext-searchbox.js"></script>
    <script src="src/ext-statusbar.js"></script>
    <script src="src/ext-chromevox.js"></script>
    <script type="text/javascript">
        var editor, hasEdit, language;
        window.onload = function () {
            ace.require("ace/ext/chromevox");
            language = getLanguage();//设置语言
            init();
        };
        function init() {
            var lang = getId("lang");
            var title = getId("headTitle");
            var bar = getId("headBtns");
            var width = (window.innerWidth - bar.offsetWidth - 10);
            title.style.width = width + "px";
            lang.style.maxWidth = (width - 25) + "px";
            editor = ace.edit("vbeditor");
            var StatusBar = ace.require("ace/ext/statusbar").StatusBar;
            var statusBar = new StatusBar(editor, document.getElementById("statusBar"));
            editor.setTheme("");
            editor.session.setMode("ace/mode/" + language);
            //editor.session.setUseSoftTabs(true);
            editor.setShowPrintMargin(false);
            editor.setAnimatedScroll(true);
            //editor.session.setUseWrapMode(true);
            editor.focus();
            ace.require("ace/ext/language_tools");
            editor.setOptions({
                enableBasicAutocompletion: true,
                enableSnippets: false,
                enableLiveAutocompletion: true
            });
            editor.$blockScrolling = "Infinity";
            editor.session.on("change", function () {
                hasEdit = true;
                getId("headTitle").className = "title";
            });
        }
        function getLanguage() {
            var title = document.getElementById("lang");
            var url = location.search;
            var theRequest = new Object();
            if (url.indexOf("?") != -1) {
                var str = url.substr(1).split("=");
                title.innerText = str[0];
                return str[1];
            }
            title.innerText = "Java";
            return "java";
        }

        function getId(id) {
            return document.getElementById(id);
        }

        function exec(obj, name, args) {
            editor.execCommand(name, args);
            if (obj)
                editor.focus();
        }

        function save() {
            if (hasEdit == true) {
                hasEdit = false;
                getId("headTitle").className = "";
                window.EditorManage.save(editor.getValue());
            }
        }

        function openFile(text) {
            editor.setValue(text);
            editor.selection.clearSelection();
        }

        function remove(obj) {
            obj.removeAttribute("class");
        }
    </script>
</body>
</html>
